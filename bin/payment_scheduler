#!/usr/bin/env ruby
# encoding: utf-8

$: << File.expand_path("lib")

require "shushu"
require "stalker"

shulog("starting payment scheduler")
PaymentService.ready_process.each do |pend|
  recid, pmid = pend["receivable_id"], pend["payment_method_id"]
  shulog("#enqueue_payment_process receivable=#{recid} payment_method=#{pmid}")
  Stalker.enqueue("payment.process",{:recid  => recid, :pmid => pmid})
end
shulog("stopping payment scheduler")
