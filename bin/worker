#!/usr/bin/env ruby
# encoding: utf-8

$: << File.expand_path("lib")

require "shushu"
require "stalker"
include Stalker

Log.info("starting worker")

job("payment.process") do |args|
  recid, pmid = args["recid"], args["pmid"]
  Log.info("#payment_service_process receivable=#{recid} payment_method=#{pmid}")
  PaymentService.process(recid, pmid)
  Log.info("#payment_service_process_complete receivable=#{recid} payment_method=#{pmid}")
end

Stalker.work
